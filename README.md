# がん登録推進法20条により院内がん登録へ提供された生存確認情報の活用にあたって
## 背景
 [がん登録等の推進に関する法律](https://laws.e-gov.go.jp/law/425AC0100000111/20230401_503AC0000000037#Mp-Ch_3)20条の規定によれば、各施設は全国がん登録に届出した症例について、都道府県の全国がん登録担当部署に請求すれば院内がん登録または研究のために、生存確認情報（最終生存確認日/死亡日、死亡している場合には死因）の提供を受けることができます。\
 しかし、これらの情報そのものは第3者提供が禁止されていることから、多施設共同研究などで予後分析を行う場合には、以下の加工をすることが条件とされています。（[厚生労働省・国立がん研究センター、全国がん登録利用マニュアル（令和7年4月版）](https://www.mhlw.go.jp/content/10900000/001469687.pdf) 27-28ページ）
 - 診断日等の「起算日」を定める
 - 最終生存確認日、死亡日は、起点日からの日数に変換する
 - 起算日は、年月までとして、日の情報を削除する
 - 死因情報は、「がん」か「がん以外」かの区別のみとする

しかし、このような処理をするのは手動で行うのはかなりの手間になります。
そこで、上記のうち、診断日からの日数変換の部分を自動化するプログラムを作成しました。これを各施設内で使用すれば、院内がん登録のファイルから、院内がん登録内の「診断日」を起点として、最終生存確認日、死亡日だけでなく、当該腫瘍初診日、多施設診断日、自施設診断日、各種治療の日も併せて、全て「日数」に変換した上で、診断日を、年月までの情報とするため「日」の情報を00に置き換えることができます。\
（ただし、死因の加工は行っておりませんのでご注意ください。）

## 説明
python 3.12.10で動作確認しています。\
main.pyとsub.pyを同じフォルダに配置して、main.pyを実行すれば、ファイルを指定するウィンドウが現れます。\
処理対象の、院内がん登録ファイル（「元ファイル」)を選択(csv）と、出力先フォルダを指定して、「処理実行」のボタンを押せば、元ファイルのファイル名にｰoutを付けたcsvファイルが生成されます。
既に、同名のファイルがある場合には、ファイル名の後ろに-nを付けたファイルが作成されます。

### 動作
対象ファイルの１行目に項目名として加工対象の列を判定します。\
'診断日'を起点として、\
'当該腫瘍初診日','他施設診断日','自施設診断日','外科的治療の施行日（自施設）','鏡視下治療の施行日（自施設）','内視鏡的治療の施行日（自施設）','放射線療法の施行日（自施設）','化学療法の施行日（自施設）','内分泌療法の施行日（自施設）','生存最終確認日','死亡日'の列を
を'診断日'からの日数に変換します。\
もし、日付が入っていない場合(日がすでに99の場合や、77777777, 88888888等の場合）はその部分は加工されません。\
'診断日'の日付は00に変換されます。
院内がん登録の項目には'追跡期間'という項目があり、これは、"生存最終確認日/死亡日"-"診断日"＋１で計算されています。本プログラムで算出される日数は、最後の+1がありませんので、１少なくなりますのでご注意ください。
## 注意
当プログラムは、利用者の責任においてご活用ください。\
Creative Commons licenseで公開しますので、自由に加工していただいて結構です。再配布なども自由です。

